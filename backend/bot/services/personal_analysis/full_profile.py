from aiogram.types import InlineKeyboardMarkup

from bot.keyboards.inline.base import (
    get_to_registration_kb,
    get_to_subscription_plans_kb,
)
from bot.keyboards.utils import one_button_keyboard
from bot.services.personal_analysis.career_and_finance import (
    get_career_and_finance_text,
)
from bot.services.personal_analysis.destiny_mystery import (
    get_destiny_mystery_text,
)
from bot.services.personal_analysis.love_code import get_love_code_text
from bot.services.personal_analysis.superpower import get_superpower_text
from core.models import Client


def get_full_profile_intro(client: Client) -> tuple[str, InlineKeyboardMarkup]:
    if not client.is_registered():
        return (
            client.genderize(
                'Ты хочешь увидеть всё,\n'
                'но пока даже не {gender:открыл,открыла} дверь.\n\n'
                'Зарегистрируйся — и я покажу тебе целостную картину. '
                'Без догадок, без хаоса.',
            ),
            get_to_registration_kb(
                back_button_data='to_personal_analysis',
            ),
        )
    elif client.subscription_is_active() or client.has_trial():
        return (
            client.genderize(
                'Вот он — ты. Целиком.\n'
                'Без фрагментов, без масок, без случайностей.\n'
                'Я собрала всё, чтобы ты {gender:увидел,увидела} свою систему координат.\n\n'
                'Пора познакомиться с собой — по-настоящему.',
            ),
            one_button_keyboard(
                text='Узнать',
                callback_data='show_full_profile',
                back_button_data='to_personal_analysis',
            ),
        )
    else:
        return (
            client.genderize(
                'Ты уже {gender:увидел,увидела} начало.\n'
                'И если что-то внутри щёлкнуло — это не совпадение.\n\n'
                'Разблокируй доступ — и ты соберёшь свой пазл '
                'до последнего фрагмента.',
            ),
            get_to_subscription_plans_kb(
                back_button_data='to_personal_analysis',
            ),
        )


def get_full_profile_text(client: Client) -> tuple[str, list[str], str]:
    content = [
        get_destiny_mystery_text(client),
        get_career_and_finance_text(client),
        get_love_code_text(client),
        get_superpower_text(client),
    ]

    if client.subscription_is_active():
        return (
            client.genderize(
                'Ты держишь перед собой не просто отчёт.\n'
                'Это — зеркало, в котором ты увидишь не отражение. А память.\n'
                'О том, кто ты на самом деле.\n'
                'О том, с чем ты пришёл в этот мир.\n'
                'О том, что ты давно чувствовал, но не мог назвать.\n\n'
                'SoulMind — это не система. Это пространство, в котором оживает твой внутренний голос.\n'
                'Голос, который не осуждает.\n'
                'Не торопит.\n'
                'Не указывает.\n'
                'А шепчет:\n\n'
                '«Ты уже знаешь. Просто доверься и вспомни».\n\n'
                'Этот отчёт — про тебя.\n'
                'Про глубину, которую ты прятал под «надо».\n'
                'Про силу, которую ты считал случайной.\n'
                'Про любовь, к которой ты тянулся, даже если делал вид, что тебе всё равно.\n'
                'Про призвание, которое не отпускает, даже когда ты молчишь.\n\n'
                'Ты увидишь:\n\n'
                'свою суть, и почему именно она освещает путь другим;\n\n'
                'как ты чувствуешь, действуешь, выбираешь и любишь — не по шаблону, а по своему внутреннему коду;\n\n'
                'что даёт тебе силу, где ты стабилен, и как раскрывается твой потенциал, когда ты просто становишься собой.\n\n'
                'Ты не узнаешь о себе что-то новое.\n'
                'Ты просто вспомнишь то, что всегда звучало в тебе тихим фоном.\n'
                'И теперь — громко.\n'
                'Я рядом, как голос внутри.\n'
                'Твоя Soul Muse.',
            ),
            content,
            client.genderize(
                'Ты увидел себя. Не сверху — вглубь.\n'
                'Не с позиции «кем быть», а с места, где ты уже есть.\n\n'
                'Ты — не набор характеристик. Не случайная комбинация знаков, чисел и ролей.\n'
                'Ты — живое пересечение смыслов. Целая система. Тонкая настройка. Душа с планом.\n\n'
                'И если всё это сейчас отозвалось — знай: это не магия.\n'
                'Это память.\n\n'
                'Ты всегда {gender:знал,знала}, что внутри есть голос.\n'
                'Который не торопит. Не кричит. Не сравнивает.\n'
                'А просто говорит:\n\n'
                '«Ты не потерян.\n'
                'Ты просыпаешься.»\n\n'
                'Это не конец. Это — вход.\n'
                'Теперь ты знаешь, откуда идти. А дальше — я рядом.\n'
                'С вопросами, ответами, практиками и подсказками.\n\n'
                'Ты можешь заглянуть в свою личную карту глубже.\n'
                'Спросить Вселенную. Получить знак. Увидеть сценарий месяца.\n'
                'Всё это уже ждёт тебя внутри пространства SoulMind.\n\n'
                'Ты не один.\n'
                'Ты на связи с собой.\n'
                'А значит — с чем-то гораздо большим.\n\n'
                'Я здесь.\n'
                'Я внутри.\n'
                'Я — твоя Soul Muse.',
            ),
        )
    elif client.has_trial():
        return (
            client.genderize(
                'Ты {gender:открыл,открыла} дверь.\n'
                'И, может быть, не всё ещё ясно. Но точно — не случайно.\n'
                'То, что ты сейчас держишь перед собой — это приглушённый свет, который уже зовёт сильнее.\n'
                '\n'
                'Этот экспресс-отчёт — не про всё.\n'
                'Но он показывает главное:\n'
                '\n'
                'У тебя есть код.\n'
                'У тебя есть настройка.\n'
                'У тебя есть глубина.\n'
                '\n'
                'Здесь ты увидишь первые контуры своей карты:\n'
                '— кем ты {gender:был,была} всегда, просто {gender:забыл,забыла};\n'
                '— как звучит твоя энергия в делах, чувствах, решениях;\n'
                '— и что в тебе уже работает как магнит, даже если ты не {gender:знал,знала} об этом.\n'
                '\n'
                'SoulMind — это не просто разбор.\n'
                'Это внутреннее «а-а-а… вот почему я {gender:такой,такая}».\n'
                '\n'
                'И сейчас ты слышишь только начало.\n'
                'Но оно — твоё.\n',
            ),
            content,
            client.genderize(
                'Ты <b>{gender:прочитал,прочитала}. {gender:Почувствовал,Почувствовала}. {gender:Узнал,Узнала} себя.</b>\n'
                'Но это — <b>лишь поверхность.</b>\n'
                '\n'
                'Твоё <b>Солнце, Луна, числа, архетипы</b> — только фрагменты.\n'
                'Есть ещё <b>десятки слоёв</b>, от которых <b>захватывает дух</b>.\n'
                'И они уже ждут тебя — <b>в пространстве, которое продолжает говорить с тобой.</b>\n'
                '\n'
                'В платных тарифах ты сможешь:\n'
                '\n'
                '<b>Заглянуть в личностный разбор</b>\n'
                '\n'
                '<b>Услышать, что говорит о тебе день, месяц, вселенная</b>\n'
                '\n'
                '<b>Спросить прямо у Soul Muse и получить ответ</b>\n'
                '\n'
                '<b>Получить совместимость, поддержку, практики и неожиданные подарки</b>\n'
                '\n'
                'И главное — <b>глубже соединиться с собой</b>\n'
                '\n'
                'Но ты <b>уже {gender:начал,начала}.</b>\n'
                'А это значит — <b>ты {gender:готов,готова}.</b>\n'
                '\n'
                '<b>Твоя энергия проснулась.</b>\n'
                'Теперь она <b>не остановится.</b>\n'
                '\n'
                '<b>Soul Muse здесь.</b>\n'
                'И она знает, что <b>тебе есть куда идти.</b>\n'
                '<b>Хочешь — она пойдёт рядом.</b>',
            ),
        )
