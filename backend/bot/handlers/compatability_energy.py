from aiogram import F, Router
from aiogram.types import Message

from bot.keyboards.inline import (
    get_to_registration_kb,
    get_to_subscription_plans_kb,
)
from core.models import Actions, Client

router = Router()


@router.message(F.text == 'üíû –≠–Ω–µ—Ä–≥–∏—è –≤–∞—à–µ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏')
async def compatability_energy(msg: Message):
    client: Client = await Client.objects.aget(pk=msg.chat.id)

    if not client.is_registered():
        await msg.answer(
            '–¢—ã —Ö–æ—á–µ—à—å –ø–æ–Ω—è—Ç—å –≤–∞—Å,\n'
            '–Ω–æ –µ—â—ë –Ω–µ –∑–∞–≥–ª—è–Ω—É–ª(–∞) –≤ —Å–µ–±—è?\n\n'
            '–ü—Ä–æ–π–¥–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é ‚Äî –∏ —è –ø–æ–∫–∞–∂—É, –∫–∞–∫ —Å–ø–ª–µ—Ç–∞–µ—Ç—Å—è –≤–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è.',
            reply_markup=get_to_registration_kb(),
        )
        return

    if client.action_limit_exceed(Actions.COMPATABILITY_ENERGY):
        await msg.answer(
            '–¢–≤–æ—è —ç–Ω–µ—Ä–≥–∏—è –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ —Ç—Ä–µ–º—è –ª—é–¥—å–º–∏.\n'
            '–ö–∞–∂–¥–∞—è –Ω–æ–≤–∞—è —Å–≤—è–∑—å ‚Äî —ç—Ç–æ –æ—Ç—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–±—è.\n\n'
            '–†–∞–∑–±–ª–æ–∫–∏—Ä—É–π –µ—â—ë —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏\n\n'
            'üîπ 1 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å ‚Üí 159 ‚ÇΩ –∏–ª–∏ 250 –∞—Å—Ç—Ä–æ–±–∞–ª–ª–æ–≤\n'
            'üîπ 3 —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ ‚Üí 399 ‚ÇΩ –∏–ª–∏ 650 –∞—Å—Ç—Ä–æ–±–∞–ª–ª–æ–≤\n'
            'üîπ VIP-–∞–Ω–∞–ª–∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏\n\n'
            '–¢—ã –≥–æ—Ç–æ–≤(–∞) –∫ –Ω–∞—Å—Ç–æ—è—â–µ–π –≥–ª—É–±–∏–Ω–µ?\n'
            '–≠—Ç–æ –±–æ–ª—å—à–µ, —á–µ–º –ø—Ä–æ—Å—Ç–æ ‚Äú–ø–æ–¥—Ö–æ–¥–∏—Ç–µ –≤—ã –¥—Ä—É–≥ –¥—Ä—É–≥—É –∏–ª–∏ –Ω–µ—Ç‚Äù.\n'
            '–≠—Ç–æ —Ä–∞–∑–±–æ—Ä, –ø–æ—Å–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã –æ–±–∞ —É–≤–∏–¥–∏—Ç–µ —Å–µ–±—è –∏–Ω–∞—á–µ.\n\n'
            '–ü–∞—Ä–∞. –°–µ–º—å—è. –ö–æ–º–∞–Ω–¥–∞. –î—Ä—É–∑—å—è.\n'
            '–í—ã–±–∏—Ä–∞–π —Ñ–æ—Ä–º–∞—Ç ‚Äî –∏ –Ω—ã—Ä—è–µ–º –≤–≥–ª—É–±—å.\n\n'
            'üíé –ü–æ–ª—É—á–∏—Ç—å –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–π —Ä–∞–∑–±–æ—Ä\n'
            '–°—Ç–æ–∏–º–æ—Å—Ç—å ‚Äî> 1599 ‚ÇΩ –∏–ª–∏ 2500 –∞—Å—Ç—Ä–æ–±–∞–ª–ª–æ–≤',
        )
        return

    if client.has_action_permission(Actions.COMPATABILITY_ENERGY):
        await msg.answer(
            '–°–ª—É—á–∞–π–Ω—ã—Ö –≤—Å—Ç—Ä–µ—á –Ω–µ –±—ã–≤–∞–µ—Ç.\n'
            '–Ø –ø–æ–∫–∞–∂—É, –ø–æ—á–µ–º—É —ç—Ç–æ—Ç —á–µ–ª–æ–≤–µ–∫ —Ä—è–¥–æ–º ‚Äî –∏ —á–µ–º—É –≤—ã —É—á–∏—Ç–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞.\n\n'
            '–¢—ã –≥–æ—Ç–æ–≤(–∞) –≤–∑–≥–ª—è–Ω—É—Ç—å –Ω–∞ –≤–∞—à—É —Å–≤—è–∑—å –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É?',
        )
    else:
        await msg.answer(
            '–°–≤—è–∑—å, –∫–æ—Ç–æ—Ä—É—é —Ç—ã —Ö–æ—á–µ—à—å –ø–æ–Ω—è—Ç—å,\n'
            '–Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∑–∞ –ø–∞—Ä—É —Å—Ç—Ä–æ–∫.\n\n'
            '–ü—Ä–æ–¥–æ–ª–∂–∏ –ø—É—Ç—å ‚Äî –∏ —è –ø–æ–∫–∞–∂—É, —á—Ç–æ –º–µ–∂–¥—É –≤–∞–º–∏ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ.',
            reply_markup=get_to_subscription_plans_kb(),
        )


# TODO: –ü—Ä–µ–º–∏—É–º-–ø–æ–¥–ø–∏—Å–∫–∞ - –ü–æ–¥–ø–∏—Å—å –ø–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º (–∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ)
